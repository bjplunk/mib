code is written rather sloppily, so it'd need some cleaning up
